---
title: "fishã‚’emacs+vimãƒã‚¤ãƒ³ãƒ‰ã§ä½¿ã†"
emoji: "ğŸ“˜"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["fish", "vim"]
published: true
---
# ã¯ã˜ã‚ã«

fishã‚’vimãƒã‚¤ãƒ³ãƒ‰ã§ä½¿ã†ã«ã¯ `$HOME/.config/fish/functions/fish_user_key_bindings.fish` ã§ `fish_vi_key_bindings` ã‚’å‘¼ã³å‡ºã›ã°ã„ã„ã‚“ã ã‘ã©insert modeã§ã¯emacsãƒã‚¤ãƒ³ãƒ‰ã‚‚ä½¿ã„ãŸã„ã¨ã„ã†è´…æ²¢ãªè¦æœ›ã‚’å¶ãˆã‚‹ãŸã‚ã®è¨­å®šã‚’ç´¹ä»‹ã™ã‚‹ã€‚

# defaultãƒã‚¤ãƒ³ãƒ‰ã®è¨­å®š

insert, default, visualå„ãƒ¢ãƒ¼ãƒ‰ã®ãƒã‚¤ãƒ³ãƒ‰ã‚’defaultãƒã‚¤ãƒ³ãƒ‰ã§åˆæœŸåŒ–ã—ã¦ãŠãã€‚
```shell
for mode in insert default visual
  fish_default_key_bindings -M $mode
end
```

# vimãƒã‚¤ãƒ³ãƒ‰ã®è¨­å®š

ä¸Šã§è¨­å®šã—ãŸãƒã‚¤ãƒ³ãƒ‰ã‚’æ¶ˆã•ãªã„ã‚ˆã†ã« `--no-erase` ã‚’ä»˜ã‘ã¦vimãƒã‚¤ãƒ³ãƒ‰ã‚’è¨­å®šã™ã‚‹ã€‚
```shell
fish_vi_key_bindings --no-erase
```

# Starshipã®promptè¡¨ç¤ºã®è¨­å®š

promptã‚’è¯ã‚„ã‹ã«ã™ã‚‹ãŸã‚ã«[Starship](https://starship.rs)ã‚’ä½¿ã£ã¦ã„ã‚‹ã‚“ã ã‘ã‚Œã©ã€ã“ã“ã¾ã§ã®è¨­å®šã ã¨modeã«å¿œã˜ãŸprompt characterã®å¤‰æ›´ãŒæ©Ÿèƒ½ã—ãªã„ã€‚
`--no-erase` ã‚’ä»˜ã‘ã‚‹ã¨fishã®å¤‰æ•° `fish_key_bindings` ãŒ `insert` ã«å›ºå®šã•ã‚Œã¦ã—ã¾ã†ã“ã¨ãŒåŸå› ã®æ¨¡æ§˜ã€‚
`fish_key_bindings` å‘¼ã³å‡ºã—å¾Œã« `fish_key_bindings` ã‚’ä¸‹è¨˜ã«å¤‰æ›´ã™ã‚‹ã€‚
```shell
set fish_key_bindings fish_vi_key_bindings
```

# ã¾ã¨ã‚

ã¾ã¨ã‚ãŸè¨­å®šã¯ä¸‹è¨˜ã€‚
- C-gã§ESCã¨åŒã˜å‹•ä½œãŒã§ãã‚‹ã“ã¨
- fzfç”¨ã®è¨­å®š

ã‚‚åˆã‚ã›ã¦è¨˜è¼‰ã—ã¦ã„ã‚‹ã€‚

`$HOME/.config/fish/functions/fish_user_key_bindings.fish`
```shell
function fish_user_key_bindings
  for mode in insert default visual
    fish_default_key_bindings -M $mode
  end
  fish_vi_key_bindings --no-erase
  set fish_key_bindings fish_vi_key_bindings
  bind -s --preset \cg cancel
  bind -s --preset -M insert \cg "if commandline -P; commandline -f cancel; else; set fish_bind_mode default; commandline -f backward-char repaint-mode; end"
  bind -s --preset -M visual -m default \cg end-selection repaint-mode
  bind -s --preset -M replace_one -m default \cg cancel repaint-mode
  bind -s --preset -M replace -m default \cg cancel repaint-mode
  fzf_key_bindings
end
```

ã“ã‚Œã§insertãƒ¢ãƒ¼ãƒ‰ã§ã¯emacsãƒã‚¤ãƒ³ãƒ‰ (C-n, C-p, etc.) ãŒä½¿ãˆã¦ã€ESCã§defaultãƒ¢ãƒ¼ãƒ‰ (vimã®ãƒãƒ¼ãƒãƒ«ãƒ¢ãƒ¼ãƒ‰) ã«ç§»ã£ã¦B, Wãªã©ã§å˜èªç§»å‹•ã—ã¦ãƒ†ã‚­ã‚¹ãƒˆã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’æ´»ç”¨ã—ãŸç·¨é›†ãŒã§ãã‚‹ã€‚

# ãŠã¾ã‘

ç«¯æœ«ã¯ã“ã‚“ãªæ„Ÿã˜ã€‚
![](/images/cb3def429699fa/term.png)
